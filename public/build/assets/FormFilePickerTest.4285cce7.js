import{_ as f}from"./FormTestSetting.bf7644c3.js";import{Y as m}from"./Api.4fdb4a26.js";import{l as n,d as s,w as g,x as b,y as v}from"./vue.m.26e38986.js";import"./FormControl.ec8216db.js";import"./adminApp.8b98ecb1.js";import"./index.fb2d0054.js";import"./FormCheckRadioPicker.80cd8c70.js";import"./testComponentStore.e44842cd.js";const j={__name:"FormFilePickerTest",props:{testProps:{type:Object,default:()=>{}}},emits:["update:testProps"],setup(_,{emit:p}){const r=n([{name:"model_id",label:"ID \u0442\u043E\u0432\u0430\u0440\u0430",value:s(0)},{name:"model",value:s("goods"),label:"\u041C\u043E\u0434\u0435\u043B\u044C",type:"select",options:[{label:"goods",value:"goods"}]},{name:"mode",label:"\u0420\u0435\u0436\u0438\u043C",options:{create:"\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435",edit:"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435"},value:s("create"),type:"radio"},{name:"upload",label:"Upload",value:s(1),type:"checkbox",options:["\u0414\u0430"]},{name:"submit",label:"\u0417\u0430\u043F\u0443\u0441\u0442\u0438\u0442\u044C \u043A\u043E\u043C\u043F\u043E\u043D\u0435\u043D\u0442",value:s(null),type:"button",color:"success",role:"run",click(){t.run=!0,Object.keys(r).forEach(o=>{const e=r[o];t[e.name]=e.value}),t.mode=="edit"&&i()}}]),t=n({run:!1,mode:s("cteate"),upload:s(!1),testFiles:[],previews:[]});g(()=>t.run,o=>{p("update:testProps",t)}),m("get-samples-images").success(o=>{const e=o.map(l=>new Promise((u,c)=>{m(l,"get",null,{responseType:"blob"}).complete((a,d)=>{a||console.log("Error getting samples images"),u(d)}).fail(a=>{console.error(a),c(a)}).run()}));Promise.all(e).then(l=>{t.testFiles=l})}).run();const i=()=>{m("file/get/previews","post",{model:t.model,relate_id:t.model_id}).success(o=>{t.previews=o.filter(e=>e==null?void 0:e.small).map(e=>({imageObj:e.small.url,complete:!0,id:e.small.id}))}).run()};return(o,e)=>(b(),v(f,{formSettings:r,"onUpdate:formSettings":e[0]||(e[0]=l=>r=l)},null,8,["formSettings"]))}};export{j as default};
