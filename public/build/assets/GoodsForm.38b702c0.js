import{d,s as p,l as H,x as i,y as m,z as r,Q as b,A as l,B as a,i as q,G as z,D as Q,M as X,C,F}from"./vue.m.1a5bfe17.js";import{_ as f,a as c}from"./FormControl.8d8a1e31.js";import{Y as S,Z as D,$ as Y,X as Z,a0 as J,a1 as K,_ as L}from"./Api.38888a39.js";import{g as P,l as W,b as ee,a as oe}from"./goodsTypeRepository.e28ff620.js";import{u as O,_ as te}from"./categories.6d6ad1b4.js";import{_ as U}from"./FormCheckRadioPicker.5c0c81e0.js";import{_ as le}from"./FormFilePicker.9a09b630.js";import{s as se}from"./adminApp.15818c67.js";import{_ as ae}from"./GoodsOptionRelationships.f5c16aad.js";const de=C("h3",{class:"text-md font-medium text-slate-500 mb-4"},"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F",-1),ne=C("h3",{class:"text-md font-medium text-slate-500 mb-4"},"\u041E\u043F\u0446\u0438\u0438 \u0442\u043E\u0432\u0430\u0440\u0430",-1),re={key:1,class:"text-slate-400 mb-2"},ie={class:"flex justify-between"},ye={__name:"GoodsForm",props:{category:{default:null},mode:{default:"create"},goodsId:{type:Number,default:null},goodsLoad:{type:Boolean,default:!1},goodsData:{type:Object,default:null},buttonCloseForm:{type:Boolean,default:!1}},emits:["close-form"],setup(h,{emit:ue}){const n=h,u=d(n.mode),g=d(n.goodsId),G=p(()=>u.value=="create"?"\u0421\u043E\u0437\u0434\u0430\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430":"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430"),{fetchAllCategories:I}=O(),{listCategories:w,loading:M}=se(O());I();const N=p(()=>{const o=w.value.map(e=>({value:e.id,label:e.name}));return o.unshift({value:0,label:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E"}),o}),B=d(0);d(0);const T=p(()=>{var o;return(o=w.value.find(({id:e})=>e==B.value))==null?void 0:o.goods_type}),j={none:"\u0411\u0435\u0437 \u0441\u0442\u0438\u043A\u0435\u0440\u0430",new:"\u041D\u043E\u0432\u0438\u043D\u043A\u0430",hit:"\u0425\u0438\u0442",bonus:"\u0411\u043E\u043D\u0443\u0441"},A={1:"\u0414\u0430"},t=H({id:g,name:null,category_id:B,description:null,price:1,sticker:"none",goods_type:T.value,hidden:1,mode:u}),v=p({get:()=>[t.hidden],set:o=>{t.hidden=o[0]}}),V=(o,e)=>{o=="update"?(u.value="update",e&&(g.value=e)):(u.value="create",g.value&&(g.value=null))},y=d(null),_=d(null),k=d(!1),E=()=>{k.value=!0,_.value=null,S("goods/store","post",t).setErrors(y).setLoader(k).success(o=>{_.value=o!=null&&o.goods_id?"\u0422\u043E\u0432\u0430\u0440 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D":"\u0422\u043E\u0432\u0430\u0440 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D",V("update",o==null?void 0:o.goods_id)}).run()},x=d(null),$=d(!1);if(n.goodsLoad&&($.value=!0,S("goods/get","get",{id:n.goodsId}).setErrors(x).setLoader($).success(o=>{V("update",o.id);for(const e of Object.keys(t))t[e]=o[e]}).run()),n.goodsData){for(const o of Object.keys(n.goodsData))t[o]=n.goodsData[o];V("update",n.goodsData.id)}const R=p(()=>u=="create"?"\u0421\u043E\u0437\u0434\u0430\u0442\u044C":"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C");return(o,e)=>(i(),m(oe,{title:a(G),form:"",onSubmit:F(E,["prevent"]),class:"shadow-sm",loader:$.value},{default:r(()=>[x.value?(i(),m(D,{key:0,errors:x.value,class:"-mt-6"},null,8,["errors"])):b("",!0),l(c,{label:"\u0418\u043C\u044F \u0442\u043E\u0432\u0430\u0440\u0430"},{default:r(()=>[l(f,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=s=>t.name=s),icon:a(Y),placeholder:"\u0411\u0443\u0440\u0433\u0435\u0440"},null,8,["modelValue","icon"]),l(f,{modelValue:t.category_id,"onUpdate:modelValue":e[1]||(e[1]=s=>t.category_id=s),icon:a(Z),options:a(N),placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044E",loader:a(M)},null,8,["modelValue","icon","options","loader"])]),_:1}),l(c,{label:"\u0422\u0438\u043F \u0442\u043E\u0432\u0430\u0440\u0430"},{default:r(()=>[l(f,{modelValue:t.goods_type,"onUpdate:modelValue":e[2]||(e[2]=s=>t.goods_type=s),options:a(P),loader:a(W)},null,8,["modelValue","options","loader"])]),_:1}),l(c,{label:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430"},{default:r(()=>[l(f,{modelValue:t.description,"onUpdate:modelValue":e[3]||(e[3]=s=>t.description=s),icon:a(J),type:"textarea",placeholder:"\u041E\u043F\u0438\u0441\u0430\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430"},null,8,["modelValue","icon"])]),_:1}),l(c,{label:"\u0426\u0435\u043D\u0430"},{default:r(()=>[l(f,{modelValue:t.price,"onUpdate:modelValue":e[4]||(e[4]=s=>t.price=s),icon:a(K),placeholder:"100.00"},null,8,["modelValue","icon"])]),_:1}),l(c,{label:"\u0421\u0442\u0438\u043A\u0435\u0440"},{default:r(()=>[l(U,{modelValue:t.sticker,"onUpdate:modelValue":e[5]||(e[5]=s=>t.sticker=s),name:"sticker",type:"radio",options:j},null,8,["modelValue"])]),_:1}),l(c,{label:"\u0421\u043A\u0440\u044B\u0442"},{default:r(()=>[l(U,{modelValue:a(v),"onUpdate:modelValue":e[6]||(e[6]=s=>q(v)?v.value=s:null),name:"sample-switch",type:"switch",options:A},null,8,["modelValue"])]),_:1}),l(te),de,l(le,{model:"goods",model_id:t.id,mode:t.mode,label:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435",class:"mb-4"},null,8,["model_id","mode"]),ne,u.value=="create"?(i(),z("div",re," \u0414\u043B\u044F \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u043E\u043F\u0446\u0438\u0439 \u043A \u0442\u043E\u0432\u0430\u0440\u0443, \u0432\u043D\u0430\u0447\u0430\u043B\u0435 \u0441\u043E\u0437\u0434\u0430\u0439\u0442\u0435 \u0442\u043E\u0432\u0430\u0440 ")):(i(),m(ae,{key:2,class:"mb-2 -mx-6","goods-id":t.id,"opened-goods":t},null,8,["goods-id","opened-goods"])),y.value?(i(),m(D,{key:3,errors:y.value},null,8,["errors"])):b("",!0),_.value?(i(),m(ee,{key:4,color:"success",timeout:"5000"},{default:r(()=>[Q(X(_.value),1)]),_:1})):b("",!0),C("div",ie,[l(L,{type:"submit",color:"info",label:a(R),loader:k.value,"loader-type":"circle2"},null,8,["label","loader"]),h.buttonCloseForm?(i(),m(L,{key:0,type:"submit",color:"danger",label:"\u041E\u0442\u043C\u0435\u043D\u0430",onClick:e[7]||(e[7]=F(s=>o.$emit("close-form"),["prevent"]))})):b("",!0)])]),_:1},8,["title","onSubmit","loader"]))}};export{ye as _};
